---
tags:
  - study
  - 이펙티브자바
title: 인터페이스는 구현하는 쪽을 생각해 설계하라
chapter: 아이템 21
---
## 인터페이스는 구현하는 쪽을 생각해 설계하라
- 자바 8 이전에는 기존 구현체를 깨뜨리지 않고는 인터페이스에 메세더를 추가할 방법이 없었다. (컴파일 오류)
- 자바 8 에서는 컬렉션 인터페이스들에 다수의 디폴트 메서드가 추가되었다. 주로 람다를 활용하기 위해서였다.
- 자바 라이브러리의 디폴트 메서드는 코드 품질이 높고 범용적이라 대부분 잘 작동한다. 하지만 **생각할 수 있는 모든 상황에서 불변식을 해치지 않는 디폴트 메서드를 작성하기란 어려운 법이다.**
	- 불변식이란 프로그램이 실행되는 동안 항상 참이어야 하는 조건을 말한다.
	- 예) collection 인터페이스의 불변식: size( ) 메서드는 항상 올바른 요소 개수를 반환해야한다.
	- 인터페이스에 디폴트 메서드를 추가할 때, **구현 클래스가 어떻게 동작할지**를 정확히 예측할 수 없기 때문에 특정 구현 클래스에서는 불변식이 깨질 수 있다.

```java
public interface Animal {
    void walk();
    void bark();
}

public class Dog implements Animal {

    @Override
    public void walk() {
        System.out.println("뚜벅 뚜벅");
    }
    
    @Override
    public void bark() {
        System.out.println("멍멍");
    }
}
```
- 디폴트 메서드는 기존 구현체에 런타임 오류를 일으킬 수 있다.
	- 추가하려는 디폴트 메서드가 기존 구현체들고 충돌하지는 않을지 심사숙고해야함.

### 인터페이스를 설계할 때는 세심한 주의를 기울이자.
- 디폴트 메서드는 기존 인터페이스에 추가하는 것은 많은 위험이 동반된다.
- 새로운 인터페이스는 릴리즈 전에 반드시 테스트를 통한 문제가 없는지 확인해야한다.
	- 여러 방식으로 구현 및 테스트
	- 인터페이스의 인스턴스를 활용하는 클라이언트를 통한 테스트
- 릴리즈 한 후라도 결함을 수정하는게 가능한 경우도 있지만 그 가능성에 기대지 말자.
