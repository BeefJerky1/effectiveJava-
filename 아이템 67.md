---
tags:
  - study
  - 이펙티브자바
title: 최적화는 신중히 하라
chapter: 아이템 67
---
## 최적화는 신중히 하라

### 핵심
- 빠른 프로그램을 작성하려고 안달하지 말자. 좋은 프로그램을 작성하다보면 성능은 따라오게 마련이다. 하지만 시스템을 설계할때, 특히 `API`, 네트워크 프로토콜, 영구 저장용 데이터 포맷을 설계할때는 성능을 염두에 두어야 한다. 
- 시스템 구현을 완료했다면 이제 성능을 측정해보라. 충분히 빠르면 그것으로 끝이다. 그렇지 않다면 프로파일러를 사용해 문제의 원인이 되는 지점을 찾아 최적화를 수행하라. 
- 가장 먼저 어떤 알고리즘을 사용했는지 살펴보자. 알고리즘을 잘못 골랐다면 다른 저수준 최적화는 아무리 해봐야 소용이 없다. 만족할때까지 이 과정을 반복하고, 모든 변경후에는 성능을 측정하라.

### 최적화의 진실
- 좋은 결과보다 해로운 결과로 이어지기 쉽다.
- 빠르지도 않고 재대로 동작하지도 않으면서 수정하기는 어려운 프로그램을 탄생시킨다.
- 빠른 프로그램 보다는 좋은 프로그램을 작성하라.

### 설계 단계에서 성능을 염두하자.
- 성능을 제한하는 설계를 피해라.
	- 완성후 변경이 어렵거나 불가능할 수 있다.
	- 동시에 시스템 성능을 심각하게 제한할 수 있다.
- `API` 설계할때 성능에 주는 영향을 고려하라.
	- 컴포지션으로 해결할 수 있음에도 상속으로 설계하면 성능제약까지도 물려받는다.
	- 인터페이스 대신 구현 타입을 사용하는 것도 좋지 않다. 구현체에 종속되어 더 빠른 구현체가 나오더라도 이용하지 못한다.
- 잘 설계된 `API`는 성능도 좋은 게 보통이다.
	- 성능을 위해 `API` 를 왜곡하는건 매우 안좋은 생각이다.
### 최적화 규칙
- 하지마라
- 아직하지마라
- 최적화 시도 전후로 성능을 측정하라
### 프로파일링 도구를 사용하라
- 최적화 노력을 어디에 집중해야 할지 찾는데 도움을 준다.
	- 런타임 정보를 제공하며, 알고리즘을 변경해야 한다는 사실도 알려준다.
- `jmh`도 언급해둘만한 도구다. 자바 코드의 상세한 성능을 알기 쉽게 보여주는 마이크로 벤치마킹 프레임워크다.
-