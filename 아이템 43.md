---
tags:
  - study
  - 이펙티브자바
title: 람다보다는 메서드 참조를 사용하라
chapter: 아이템 43
---
## 람다보다는 메서드 참조를 사용하라

### 핵심
- 메서드 참조는 람다의 간단명로한 대안이 될 수 있다.
- 메서드 참조쪽이 짧고 명확하다면 메서드 참조를 쓰고, 그렇지 않을때만 람다를 사용하라.

### 메서드 참조
- **클래스명::메서드명** 으로 사용
- 메서드 참조는 주로 **정적 메서드**, **인스턴스 메서드**, **생성자** 등을 참조할 때 사용됩니다.
- 메서드 참조란, 함수 객체를 람다보다 간결하게 만드는 방법

### 람다

```java
map.merge(key, 1, (count, incr) -> count + incr);
```

- `merge()` : 키, 값, 함수를 인자로 받으며 주어진 키가 맵 안에 아직 없다면 주어진 `{키,값}` 쌍을 그대로 저장하고, 키가 이미 있다면 `{키, 인자로 받은 함수의 결과}` 쌍을 저장
- 하지만, 현재 람다는 단순 두 인수의 합을 반환할뿐이기 때문에 불필요한 코드 부분(매개변수를 받는 부분)이 존재하게 된다.
### 메서드 참조

```java
map.merge(key, 1, Integer::sum);
```
- 이런 경우, 자바 8부터 도입된 모든 기본 타입의 박싱 타입에서 제공하는 **정적 메소드** `sum()`을 사용하여 메서드의 참조를 전달하면 코드가 더 간결해진다.


###  메서드 참조 장점

- 메서드 참조로 구현한다면, **더 짧고 간결한 코드**를 생성할 수 있다.  
- 즉 람다로 구현했을때 너무 길고 복잡하다면, **람다로 작성할 코드를 새로운 메서드에 담은 다음, 람다 대신 그 메서드 참조를 사용**하면 된다.

 #### **람다가 메서드 참조보다 간결한 경우**  
 -  메서드와 람다가 같은 클래스에 있는 경우 람다가 더 간결하다.
```java
service.excecute(CoshThisClassNameIsHumongous::action); //메서드 참조
```

```java
service.execute(() -> action()); //람다
```

### 메서드 참조 유형

#### 1. 정적 메서드 참조
- **정적 메서드 참조**는 클래스명::메서드명으로 정의된 메서드를 참조하는 방식
- 인스턴스 없이 클래스 자체의 메서드를 참조

```java
Integer::parseInt
```

```java
str -> Integer.parseInt(str)
```

#### 2.인스턴스 메서드 참조

#### 2-1. 한정적(bound) 인스턴스 메서드 참조

- 수신객체(참조 대상 인스턴스)를 특정하는 참조이며, 즉 함수 객체가 받는 인수와 참조되는 메서드가 받는 인수가 같다.
- 한정적 인스턴스 메서드 참조는 "특정 객체의 메서드를 참조"
	- 즉 객체에 속한 메서드를 사용한다/

```java
Instant.now()::isAfter
```

```java
Instant then = Instant.now(); 
t -> then.isAfter(t)
```

#### 2-2. 비한정적(unbound) 인스턴스 메서드 참조
- 수신객체를 특정하지 않는 참조이며, 함수 객체를 적용하는 시점에 수신 객체를 알려준다.
- 주로 스트림 파이프라인에서의 매핑과 필터 함수에 쓰인다.
- 객체를 따로 지정하지 않고 객체가 제공하는 메서드를 일반적으로 사용할 수 있는 방식

```java
String::toLowerCase
```

```java
str -> str.toLowerCase()
```

#### 3. 클래스 생성자
- 생성자 호출하는 람다 표현식을 대체함.
- 생성자를 직접호출하는 대신 참조할 수 있게 해줌
- 매개변수가 없는 생성자 참조는 간다하고 유용하지만 매개변수가 있다면 별로 Function, BiFunction 인터페이스를 사용해야함. 더 복잡해질 수 있음.
```java
TreeMap<K,V>::new
```

```java
() -> new TreeMap<K,V>()
```

#### 4. 배열 생성자
- `[]::new` 형식으로 사용됨. 
- 배열의 크기를 동적으로 지정하여 배열을 생성하는데 사용된다. 
- `IntFunction<T>` 의 apply 메서드를 사용하면 배열을 동적을 생성가능하고 배열의 크기를 나중에 지정해서 생성가능. #추가공부필요 

```java
int[]::new
```

```java
len -> new int[len]
```

### 람다로는 불가능하나 메서드 참조만 가능한 경우 #추가공부필요 

- 보통, 람다로 할 수 없는 일이라면 메서드 참조로도 할 수 없다.  
- 하지만, **제네릭 함수 타입**(genereic function type)을 구현할때는 **람다 사용이 불가능하고 오직 메서드 참조만 가능**하다.
- 람다는 타입 추론을 사용하기 때문에 컴파일러가 제네릭 타입을 추론해야함. 그러나 제네릭은 타입 소거가 되서 타입 정보가 사라지므로 람다 표현식이 타입에 맞게 동작하는 것이 어려울 수 있다.
- 메서드 참조는 타입을 명확히 지정할 수 있어서 제네릭 타입에 대한 안전성을 보장한다.

```java
interface G1 {
   <E extends Exception> Object m() throws E;
}

interface G2 {
   <F extends Exception> String m() throws Exception;
}

interface G extends G1, G2 {}
```

- 함수형 인터페이스 G를 함수 타입으로 표현하면 다음과 같다.

```null
<F extends Exception> () -> String throws F
```

- 즉 함수형 인터페이스를 위한 제네릭 함수 타입은 메서드 참조 표현식으로는 구현할 수 있지만, 람다식으로는 불가능하다.


### 음
- 메서드 참조는 명시적으로 특정 클래스나 객체의 메서드를 참조하는 방식. 즉 어떤 메서드를 호출할지 명확하게 지정
- 람다는 문맥에 따라 어떤 메서드를 호출할지 추론하는 방식. 람다 표현식이 사용되는 위치나 변수타입을 기반을 메서드 호출을 유추한다.
- 결국 메서드 참조는 어떤 메서드를 명시적으로 참조하는 방식이고 람다는 문맥을 통해 메서드를 자동으로 추론하는 방식.


## 발표
- 람다를 더 간결하게 만드는 방법이 있다. 바로 메서드 참조이다.
- map.merge(key, newValue, (oldValue, newValue) -> 병합 결과) , 3번째 인자는 병합 함수로 키가 이미 존재하면 기존값과 새로운 값을 병합하여 저장한다. 키가 없으면 newValue를 저장
- 매개변수 대신에 메서드 참조를 전달하면 똑같은 결과를 더 보기 좋게 얻을 수 있다.

### 람다와 메서드 참조
- 메서드 참조를 사용하는 편이 보통은 더 짧고 간결하다.
- 메서드 참조에는 기능을 잘 드러내는 이름을 지어줄 수 있고 설명을 문서로 남길 수 있다.
- IDE들은 람다를 메서드 참조로 대체하라고 권한다. 하지만 때론 람다가 메서드 참조보다 간결할 때도 있다.

### 메서드 참조 유형
-  정적 메서드 참조
	- 클래스이름::정적메서드
	- 예) String::valueOf
-  한정적 인스턴스 메서드 참조
	- 객체참조::인스턴스메서드
	- 특정 객체에 대해 인스턴스 메서드를 호출하는 경우 사용
	- 예) str::length
-  비한정적 인스턴스 메서드 참조
	- 클래스이름::인스턴스메서드
	- 아직 객체가 정해지지 않은 상태에서 인스턴스 메서드를 참조하는 경우 사용
	- 예) String :: length
- 클래스 생성자 참조
	- 클래스이름 ::new
	- 클래스의 인스턴스를 생성하는 경우 사용
	- 예) String :: new
- 배열 생성자 참조
	- 타입 [] :: new
	- 람다식 없이 배열을 동적으로 생성할 때 사용
	- 예) int [] :: new